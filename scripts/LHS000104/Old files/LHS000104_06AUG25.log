NOTE: PROCEDURE PRINTTO used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

6          
7          /*
8          
9          	Program name: LHS000104.sas	
10         
11         	Description: 	Fits the cloglog model and print the rtf report (Table 3)
12         
13         	Author: 		Alvaro Quijano
14         
15         	SAS version: 	9.4
16         
17         	Creation date: 	28jul25
18         
19         	History: 		31jul25: Add the code to print rtf report
20         					06aug25: Update input dataset from *_30jul25 to *06aug25
21         							 Use birth_weight_c3 instead of *_c4
22         							 Add preceding_birth_interval_lt36 to the model
2                                                          The SAS System                            11:55 Wednesday, August 6, 2025

23         							 Drop preceding_birth_interval_c3 from the model
24         							 Renamed to Table 3
25         						 		
26         	Input: 	&homepath./data/derived/lhs000103_06aug25.sas7bdat	
27         
28         	Output: &homepath./output/lhs000104_T3_06aug25.rtf
29         			&homepath./data/derived/lhs000104_06aug25.sas7bdat
30         
31         */
32         options nonumber nodate;
33         
34         * Import libraries;
35         libname raw "&homepath/data/raw" ACCESS=READONLY;
NOTE: Libref RAW was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: J:\HCHS\STATISTICS\GRAS\QAngarita\LHS\LHS0001\data\raw
36         libname derv "&homepath/data/derived";
NOTE: Libref DERV was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: J:\HCHS\STATISTICS\GRAS\QAngarita\LHS\LHS0001\data\derived
37         run;
38         
39         * Include needed files;
40         %include "&homepath./scripts/LHS000190/lhs000190.sas";
NOTE: Format ETHNICITY_C3_FMT has been output.
NOTE: Format MEDUC_C3_FMT has been output.
NOTE: Format MEDUC_C2_FMT has been output.
NOTE: Format FLOOR_MAT_C4_FMT has been output.
NOTE: Format CHILD_SEX_FMT has been output.
NOTE: Format HH_HEAD_C4_FMT has been output.
NOTE: Format FUEL_COOKING_C3_FMT has been output.
NOTE: Format MOM_OCCUPATION_C3_FMT has been output.
NOTE: Format PRECEDING_BIRTH_INTERVAL_C4_FMT has been output.
NOTE: Format PRECEDING_BIRTH_INTERVAL_C3_FMT has been output.
NOTE: Format BIRTH_WEIGHT_C4_FMT has been output.
NOTE: Format AGE_MONTH_FMT has been output.
NOTE: Format WEALTH_INDEX_FMT has been output.
NOTE: Format WEALTH_INDEX_C3_FMT has been output.
NOTE: Format MAGE_BIRTH_FMT has been output.
NOTE: Format MAGE_BIRTH_C3_FMT has been output.
NOTE: Format URBAN_FMT has been output.
NOTE: Format ANC_QUALITY_SCORE_C2_FMT has been output.
NOTE: Format BIRTH_ORDER_C3_FMT has been output.
NOTE: Format BIRTH_ORDER_SPACING_C5_FMT has been output.
NOTE: Format REFNUM has been output.
NOTE: The NEGPAREN (in)format was specified on the right-hand side of an equal sign, but without a length specification. PROC 
      FORMAT will assume a default length of at least 40 for the format being generated. If this is an insufficient width, you can 
      rerun PROC FORMAT with an explicit width for the NEGPAREN (in)format, or provide a sufficient DEFAULT= option.
NOTE: Format PAREN has been output.
NOTE: Format PV has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
      

167        %include "&homepath./scripts/LHS000191/lhs00019103.sas";
233        
                                                           The SAS System

234        * define macro variables;
235        %let db_out = derv.&job._&sysdate.;
236        %let db_in = derv.LHS000103_06aug25;
237        
238        ods escapechar '^';
239        
240        * Count number of ids;
241        proc sql noprint;
242        	select count(distinct(cats(womenid,birthid))) into:n_births
243        	from &db_in;
244        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.93 seconds
      cpu time            0.26 seconds
      

245        
246        * Fit the logistic model;
247        proc surveylogistic data = &db_in;
248        	by _imputation_;
249        	cluster psu;
250        	strata strata;
251        	weight weight;
252        	class age(Ref="1") meduc_c3(Ref="1") wealth_index_c3(ref='3') mage_birth_c3(ref="1") preterm_birth(ref='0')
252      ! birth_order_spacing_c5(ref='0')
253        		  birth_weight_c3(ref="2") child_sex(ref='1') urban ethnicity_c3(ref='3') anc_quality_score_c2(ref='1')
253      ! any_substance_use(ref='1') / param=ref;
254        	model died(event='1') = age child_sex birth_weight_c3 preterm_birth meduc_c3 ethnicity_c3  wealth_index_c3
255        								 urban anc_quality_score_c2 birth_order_spacing_c5 mage_birth_c3 any_substance_use / link = cloglog;
256        	ods output  ParameterEstimates = db_estimates0;
257        run;

NOTE: The BY statement provides completely separate analyses of the BY groups.  It does not provide a statistically valid 
      subpopulation or domain analysis, where the total number of units in the subpopulation is not known with certainty. If you 
      want a domain analysis, you should include the DOMAIN variables in a DOMAIN statement.
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=1
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=2
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=3
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=4
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=5
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
                                                           The SAS System

      Imputation Number=6
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=7
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=8
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=9
NOTE: PROC SURVEYLOGISTIC is modeling the probability that died=1.
NOTE: Convergence criterion (GCONV=1E-8) satisfied.
NOTE: The above message was for the following BY group:
      Imputation Number=10
NOTE: The data set WORK.DB_ESTIMATES0 has 250 observations and 10 variables.
NOTE: The PROCEDURE SURVEYLOGISTIC printed pages 1-40.
NOTE: PROCEDURE SURVEYLOGISTIC used (Total process time):
      real time           24.13 seconds
      cpu time            15.67 seconds
      

258        
259        * Arrange the dataset with the beta estimates;
260        data db_estimates;
261          length Parameter $82;
262          set db_estimates0;
263        
264           if missing(ClassVal0) then
265            Parameter = Variable;
266          else
267            Parameter = catx('_', Variable, ClassVal0);
268        
269          keep _imputation_ Parameter Estimate StdErr DF;
270        run;

NOTE: There were 250 observations read from the data set WORK.DB_ESTIMATES0.
NOTE: The data set WORK.DB_ESTIMATES has 250 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

271        
272        * Obtain the list of effects to use in MIANALYZE;
273        proc sql noprint;
274        	select distinct Parameter into:var_list separated by ' '
275        	from db_estimates
276        	;
277        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

278        
                                                           The SAS System

279        * Combine the estimates;
280        proc mianalyze parms=db_estimates;
281        	modeleffects &var_list;
282        	ods output ParameterEstimates = db_estimates_pooled_mi;
283        run;

NOTE: The data set WORK.DB_ESTIMATES_POOLED_MI has 25 observations and 12 variables.
NOTE: The PROCEDURE MIANALYZE printed pages 41-43.
NOTE: PROCEDURE MIANALYZE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

284        
285        * Estimates;
286        data db_estimates_pooled;
287        	set db_estimates_pooled_mi;
288        
289        	* position;
290        	pos = findc(Parm, '_', 'b');
291        
292        	if anydigit(substr(Parm, pos+1)) then do;
293        		ClassVal1 = substr(Parm, pos+1);
294        		Variable = substr(Parm, 1, pos-1);
295        	end;
296        	else do;
297        		ClassVal1 = '';
298        		Variable = Parm;	
299        	end;
300        
301        	* keep variables;
302        	keep Variable ClassVal1 Estimate StdErr Probt;
303        run;

NOTE: There were 25 observations read from the data set WORK.DB_ESTIMATES_POOLED_MI.
NOTE: The data set WORK.DB_ESTIMATES_POOLED has 25 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

304        
305        * Insert reference values;
306        proc sql noprint;
307        	insert into db_estimates_pooled (Variable,ClassVal1,Estimate)
308        	values ('wealth_index_c3','3',97)
309        	values ('mage_birth_c3','1',97)
310        	values ('birth_weight_c3','2',97)
311        	values ('child_sex','1',97)
312        	values ('urban','1',97)
313        	values ('birth_order_spacing_','0',97)
314        	values ('ethnicity_c3','3',97)
315        	values ('anc_quality_score_c2','1',97)
316        	values ('any_substance_use','1',97)
317        	values ('age','1',97)
318        	values ('meduc_c3','1',97)
319        	values ('preterm_birth','0',97);
NOTE: 12 rows were inserted into WORK.DB_ESTIMATES_POOLED.
                                                           The SAS System


320        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

321        
322        * Insert labels to use in the report;
323        data &db_out.;
324        	set db_estimates_pooled;
325        	keep order label response estimate std pv;
326        
327        	response = "Log-Hazard ratio";
328        	%labels;
329        run;

NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      12 at 328:71   
NOTE: There were 37 observations read from the data set WORK.DB_ESTIMATES_POOLED.
NOTE: The data set DERV.LHS000104_06AUG25 has 37 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

330        
331        * Print RTF report;
332        libname hchstyle 'J:\hchs\sc\styledef\sty904';
NOTE: Libref HCHSTYLE was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: J:\hchs\sc\styledef\sty904
333        ods path sashelp.tmplmst(read) hchstyle.hchs_stp(read);
334        ods listing close;
335        
336        ods rtf file = "&homepath./scripts/&job./&job._T3_&sysdate..rtf" style=manuscrt bodytitle;
NOTE: Writing RTF Body file: J:\HCHS\STATISTICS\GRAS\QAngarita\LHS\LHS0001/scripts/LHS000104/LHS000104_T3_06AUG25.rtf
337        %let fs = 11pt;
338        %let fs_body = 11pt;
339        %let fs_titles = 11pt;
340        %let lft_mgn = 1 in;
341        %let rgt_mgn = 1 in;
342        proc report data = &db_out.;
343        	title j=center height=&fs font='times roman' bold "Table 3. Discrete-Time Survival Estimates of the Hazard of Mortality
343      ! among Children under Five in Colombia, Demography and Health Survey 2015 (N=%qtrim(&n_births))";
344        	footnote1 J=LEFT HEIGHT=9.5pt FONT='times roman' "^S={leftmargin=&lft_mgn rightmargin=&rgt_mgn} Note(s): Estimates are
344      ! weighted using sampling weights and account for complex survey design." ;
345        	footnote2 J=LEFT HEIGHT=9.5pt FONT='times roman' "^S={leftmargin=1.6in rightmargin=&rgt_mgn}Log-Hazard Ratio estimates
345      ! are pooled across 10 imputed datasets following Rubin rules and standard errors incorporate both within and
345      ! between-imputation variability." ;
346        	footnote3 J=LEFT HEIGHT=10pt FONT='times roman' "{\line \line Job &job run using DHS 2015 data on %sysfunc(today(),
346      ! date9.) at%sysfunc(time(), timeampm.) }";
347        	columns order label response,(estimate std pv);
348        	define order / order group noprint order = internal;
349        	define label / display group ' ' style(header)=[just=left] style=[cellwidth=3.5in];
350        	define estimate / analysis 'Estimate' style=[vjust=bottom];
351        	define response / across ' ' ;
                                                           The SAS System

352        	define std / analysis '(SE)' style=[vjust=bottom];
353        	define pv / analysis ' ' group
354        					style=[vjust=bottom just=left]
355        					style(header)=[cellpadding = 0in cellheight=0in cellspacing=0in];
356        	format pv pv. std paren. estimate refnum. ;
357        	compute after _page_ / style = [just=left];
358        		line "* p <=.10, ** p <=.05, *** p <=.01 ";
359        	endcomp;
360        run;

NOTE: PROCEDURE REPORT used (Total process time):
      real time           0.05 seconds
      cpu time            0.03 seconds
      
NOTE: There were 37 observations read from the data set DERV.LHS000104_06AUG25.

361        ods rtf close;
362        
363        proc printto; run;

